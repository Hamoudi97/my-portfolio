const form = document.getElementById("contact-form"),
  nameInput = document.getElementById("name"),
  emailInput = document.getElementById("email"),
  messageInput = document.getElementById("message"),
  projectButtons = document.querySelectorAll(".show-btn"),
  skillBars = document.querySelectorAll(".skill-bar"),
  nameError = document.getElementById("nameError"),
  emailError = document.getElementById("emailError"),
  messageError = document.getElementById("messageError"),
  submitMessage = document.getElementById("submitMessage");
function projectToggle() {
  projectButtons.forEach((e) => {
    e.addEventListener("click", function () {
      let e = this.nextElementSibling;
      var t = "block" === e.style.display;
      (e.style.display = t ? "none" : "block"),
        (this.textContent = t ? "Show Details" : "Hide Details");
    });
  });
}
function formValidation() {
  form.addEventListener("submit", function (e) {
    (nameError.textContent = ""),
      (emailError.textContent = ""),
      (messageError.textContent = "");
    let t = !(submitMessage.textContent = "");
    if (
      ("" === nameInput.value.trim() &&
        ((nameError.textContent = "Please enter your name."), (t = !1)),
      "" === emailInput.value.trim()
        ? ((emailError.textContent = "Please enter a valid email address."),
          (t = !1))
        : validateEmail(emailInput.value.trim()) ||
          ((emailError.textContent = "Invalid email format."), (t = !1)),
      "" === messageInput.value.trim() &&
        ((messageError.textContent = "Please enter a message."), (t = !1)),
      t)
    ) {
      console.log("Form Submitted!");
      let e = form.querySelector("button[type='submit'");
      (e.disabled = !0),
        (submitMessage.textContent = "Your message has been sent! âœ…"),
        setTimeout(() => {
          form.reset(), (submitMessage.textContent = ""), (e.disabled = !1);
        }, 5e3);
    }
    e.preventDefault();
  });
}
function validateEmail(e) {
  return /^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(String(e));
}
function liveFormValidation() {
  nameInput.addEventListener("input", () => (nameError.textContent = "")),
    emailInput.addEventListener("input", () => (emailError.textContent = "")),
    messageInput.addEventListener(
      "input",
      () => (messageError.textContent = "")
    );
}
function setupDarkMode() {
  const e = document.querySelector("#checkbox");
  var t = localStorage.getItem("theme");
  t
    ? (document.documentElement.setAttribute("data-theme", t),
      "dark" === t && (e.checked = !0))
    : window.matchMedia &&
      window.matchMedia("(prefers-color-scheme: dark)").matches &&
      (document.documentElement.setAttribute("data-theme", "dark"),
      (e.checked = !0),
      localStorage.setItem("theme", "dark")),
    e.addEventListener("change", function (e) {
      e.target.checked
        ? (document.documentElement.setAttribute("data-theme", "dark"),
          localStorage.setItem("theme", "dark"))
        : (document.documentElement.setAttribute("data-theme", "light"),
          localStorage.setItem("theme", "light"));
    });
}
function setupSmoothScroll() {
  document.querySelectorAll('a[href^="#"]').forEach((e) => {
    e.addEventListener("click", function (e) {
      e.preventDefault();
      (e = this.getAttribute("href")), (e = document.querySelector(e));
      e && window.scrollTo({ top: e.offsetTop - 20, behavior: "smooth" });
    });
  });
}
function setupLazyLoading() {
  if ("IntersectionObserver" in window) {
    const e = document.querySelectorAll("img[data-src]"),
      n = new IntersectionObserver((e, t) => {
        e.forEach((e) => {
          if (e.isIntersecting) {
            const t = e.target;
            (t.src = t.dataset.src),
              (t.onload = function () {
                t.classList.add("loaded");
              }),
              t.removeAttribute("data-src"),
              n.unobserve(t);
          }
        });
      });
    e.forEach((e) => {
      n.observe(e);
    });
  } else {
    const t = document.querySelectorAll("img[data-src]");
    t.forEach((e) => {
      (e.src = e.dataset.src),
        (e.onload = function () {
          e.classList.add("loaded");
        }),
        e.removeAttribute("data-src");
    });
  }
}
function animateSkillBars() {
  setTimeout(() => {
    skillBars.forEach((e) => {
      var t = e.getAttribute("data-percentage");
      e.style.width = t + "%";
    });
  }, 350);
}
document.addEventListener("DOMContentLoaded", function () {
  projectToggle(),
    formValidation(),
    liveFormValidation(),
    setupDarkMode(),
    setupSmoothScroll(),
    setupLazyLoading(),
    animateSkillBars(),
    new Typed("#typed-text", {
      strings: ["a Student", "a Gamer", "a Foodie", "a Web Developer"],
      typeSpeed: 40,
      showCursor: !1,
      startDelay: 250,
    });
});
